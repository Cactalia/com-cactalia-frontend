<div class="container-fluid card pb-4 shadow">
    <div class="row">
        <img src="../../../../assets/img/profile/bar/2.jpg" class="bar">
        <img src="../../../../assets/img/profile/user/default.png" class="userPhoto">
    </div>
    <div class="row">
        <div class="col-12">
            <h4 class="user-name">{{this.user.name}} {{this.user.lastname}} {{this.user.secondLastname}}</h4>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-12 col-md-6 d-block text-center">
            <label class="m-0">Rol:</label>
            <p *ngIf="this.tokenUser.authorities[0] == 'ROLE_ADMIN'">Administrador</p>
            <p *ngIf="this.tokenUser.authorities[0] == 'ROLE_COORDINATOR'">Coordinador</p>
            <p *ngIf="this.tokenUser.authorities[0] == 'ROLE_PROFESSOR'">Profesor</p>
        </div>
        <div class="col-12 col-md-6 d-block text-center">
            <label class="m-0">Correo electrónico:</label>
            <p>{{this.user.email}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-12 d-flex justify-content-center">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample"
                aria-expanded="false" aria-controls="collapseExample">
                Editar perfil
            </button>
        </div>
    </div>
</div>

<div class="container-fluid card collapse shadow pb-4 my-4" id="collapseExample">
    <div class="row mt-4 mx-2">
        <form class="col-12" [formGroup]="profileForm" (ngSubmit)="updateProfile()">
            <div class="row">
                <div class="col-12">
                    <h5>Editar perfil</h5>
                </div>
                <div class="col-12">
                    <h6>Información personal</h6>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-12 col-md-4">
                    <label for="name">Nombre(s)</label>
                    <input formControlName="name" type="text" class="form-control" [class.is-invalid]="profileForm.get('name').errors" id="name" maxlength="29">
                    <small *ngIf="profileForm.get('name').errors?.required" class="form-text text-danger">Requerido.</small>
                    <small *ngIf="profileForm.get('name').errors?.pattern" class="form-text text-danger">No valido.</small>
                    <small *ngIf="profileForm.get('name').errors?.minlength" class="form-text text-danger">Al menos 3 caractéres.</small>
                    <small *ngIf="profileForm.get('name').errors?.maxlength" class="form-text text-danger">Máximo 29 caractéres.</small>
                </div>
                <div class="form-group col-12 col-md-4">
                    <label for="lastname">Apellido paterno</label>
                    <input formControlName="lastname" type="text" class="form-control" [class.is-invalid]="profileForm.get('lastname').errors" id="lastname" maxlength="29">
                    <small *ngIf="profileForm.get('lastname').errors?.required" class="form-text text-danger">Requerido.</small>
                    <small *ngIf="profileForm.get('lastname').errors?.pattern" class="form-text text-danger">No valido.</small>
                    <small *ngIf="profileForm.get('lastname').errors?.minlength" class="form-text text-danger">Al menos 3 caractéres.</small>
                    <small *ngIf="profileForm.get('lastname').errors?.maxlength" class="form-text text-danger">Máximo 29 caractéres.</small>
                </div>
                <div class="form-group col-12 col-md-4">
                    <label for="secondLastname">Apellido materno</label>
                    <input formControlName="secondLastname" type="text" class="form-control" [class.is-invalid]="profileForm.get('secondLastname').errors" id="secondLastname" maxlength="29">
                    <small *ngIf="profileForm.get('secondLastname').errors?.required" class="form-text text-danger">Requerido.</small>
                    <small *ngIf="profileForm.get('secondLastname').errors?.pattern" class="form-text text-danger">No valido.</small>
                    <small *ngIf="profileForm.get('secondLastname').errors?.minlength" class="form-text text-danger">Al menos 3 caractéres.</small>
                    <small *ngIf="profileForm.get('secondLastname').errors?.maxlength" class="form-text text-danger">Máximo 29 caractéres.</small>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12">
                    <h6>Información profesional</h6>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-12 col-md-6">
                    <label for="grade">Grado académico</label>
                    <input formControlName="grade" type="text" class="form-control" [class.is-invalid]="profileForm.get('grade').errors" id="grade" maxlength="20">
                    <small *ngIf="profileForm.get('grade').errors?.required" class="form-text text-danger">Requerido.</small>
                    <small *ngIf="profileForm.get('grade').errors?.pattern" class="form-text text-danger">No valido.</small>
                    <small *ngIf="profileForm.get('grade').errors?.minlength" class="form-text text-danger">Al menos 3 caractéres.</small>
                    <small *ngIf="profileForm.get('grade').errors?.maxlength" class="form-text text-danger">Máximo 20 caractéres.</small>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12">
                    <h6>Información de contacto</h6>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-12 col-md-6">
                    <label for="email">Correo electrónico</label>
                    <input formControlName="email" type="text" class="form-control" [class.is-invalid]="profileForm.get('email').errors" id="email" maxlength="99" (keydown.space)="$event.preventDefault();">
                    <small *ngIf="profileForm.get('email').errors?.required" class="form-text text-danger">Requerido.</small>
                    <small *ngIf="profileForm.get('email').errors?.email" class="form-text text-danger">No valido.</small>
                    <small *ngIf="profileForm.get('email').errors?.minlength" class="form-text text-danger">Al menos 6 caractéres.</small>
                    <small *ngIf="profileForm.get('email').errors?.maxlength" class="form-text text-danger">Máximo 99 caractéres.</small>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12">
                    <h6>Información de seguridad</h6>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-12 col-md-4">
                    <label for="password">Contraseña</label>
                    <input formControlName="password" type="password" class="form-control" id="password" maxlength="14" (keydown.space)="$event.preventDefault();">
                    <small *ngIf="profileForm.get('password').errors?.minlength" class="form-text text-danger">Al menos 6 caractéres.</small>
                    <small *ngIf="profileForm.get('password').errors?.maxlength" class="form-text text-danger">Máximo 14 caractéres.</small>
                </div>
            </div>
            <div class="row ">
                <div class="col-12 d-flex justify-content-end">
                    <button class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#collapseExample"
                    aria-expanded="false" aria-controls="collapseExample" [disabled]="loadingUpdate">Cancelar</button>
                    <button class="btn btn-primary ml-2" [disabled]="profileForm.invalid || loadingUpdate">
                        <span *ngIf="loadingUpdate" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Actualizar</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="container-fluid card shadow px-0 my-4" *ngIf="this.user.degrees != undefined && this.user.degrees.length >0">
    <div class="row mt-4 mx-0">
        <div class="col-12 d-flex justify-content-between align-items-center">
            <h5>Carreras asignadas</h5>
        </div>
        <div class="col-12 align-items-center">
            <h6>Total de carreras asignadas: {{this.user.degrees.length}}</h6>
        </div>
        <div class="table-responsive">
            <table class="col-12 table mt-2">
                <thead>
                    <tr>
                        <th scope="col">Nombre</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let degree of this.user.degrees">
                        <td>{{degree.name}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>